<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <title>Society Form</title>
</head>
<body class="bg-gradient-to-r from-blue-50 to-blue-100 flex items-center justify-center min-h-screen">
    <div class="bg-white/90 backdrop-blur-md p-10 rounded-2xl shadow-2xl w-full max-w-2xl border border-gray-200">
        <h2 class="text-4xl font-bold text-gray-900 mb-8 text-center"></h2>
        <form id="societyForm" class="space-y-6">
            
            <!-- Input Fields -->
            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Society Name:</label>
                <input type="text" id="societyName" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Email:</label>
                <input type="email" id="email" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Phone No:</label>
                <input type="tel" id="phone" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Street:</label>
                <input type="text" id="street" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Landmark:</label>
                <input type="text" id="landmark" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <div class="grid grid-cols-2 gap-6">
                <div class="space-y-3">
                    <label class="block text-lg font-medium text-gray-800">Pincode:</label>
                    <input type="text" id="pincode" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                </div>
                <div class="space-y-3">
                    <label class="block text-lg font-medium text-gray-800">State:</label>
                    <input type="text" id="state" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                </div>
            </div>

            <div class="space-y-3">
                <label class="block text-lg font-medium text-gray-800">Country:</label>
                <input type="text" id="country" required class="w-full p-4 text-lg border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>

            <!-- Radio Groups -->
            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold"> Is the society 30 years old?</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2"><input type="radio" name="societyAge" value="40" class="accent-blue-600"> <span>Yes</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="societyAge" value="20" class="accent-blue-600"> <span>No</span></label>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">Property card available?</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2"><input type="radio" name="propertyCard" value="10" class="accent-blue-600"> <span>Yes</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="propertyCard" value="5" class="accent-blue-600"> <span>No</span></label>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">Existing building approved plan?</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2"><input type="radio" name="buildingPlan" value="10" class="accent-blue-600"> <span>Yes</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="buildingPlan" value="5" class="accent-blue-600"> <span>No</span></label>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">DP remarks available?</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2">
                        <input type="radio" name="dpRemarks" value="10" class="accent-blue-600"> 
                        <span>Yes</span>
                    </label>
                    <label class="flex items-center space-x-2">
                        <input type="radio" name="dpRemarks" value="5" class="accent-blue-600"> 
                        <span>No</span>
                    </label>
                </div>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">TP remarks available?</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2">
                        <input type="radio" name="tpRemarks" value="10" class="accent-blue-600"> 
                        <span>Yes</span>
                    </label>
                    <label class="flex items-center space-x-2">
                        <input type="radio" name="tpRemarks" value="5" class="accent-blue-600"> 
                        <span>No</span>
                    </label>
                </div>
            </div>
            
            
            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">Road width abutting plot:</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2"><input type="radio" name="roadWidth" value="5" class="accent-blue-600"> <span>6 metre</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="roadWidth" value="5" class="accent-blue-600"> <span>9 metre</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="roadWidth" value="10" class="accent-blue-600"> <span>Above</span></label>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg border space-y-3">
                <p class="font-semibold">Consent of Members:</p>
                <div class="flex space-x-4">
                    <label class="flex items-center space-x-2"><input type="radio" name="consentMembers" value="5" class="accent-blue-600"> <span>49%</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="consentMembers" value="5" class="accent-blue-600"> <span>60%</span></label>
                    <label class="flex items-center space-x-2"><input type="radio" name="consentMembers" value="10" class="accent-blue-600"> <span>Above 75%</span></label>
                </div>
            </div>

       
            <!-- Submit Button -->
            <!-- <button type="button" onclick="submitForm()" 
                class="w-full bg-gradient-to-r from-blue-500 to-blue-700 text-white font-bold py-3 rounded-lg shadow-md hover:scale-105 transition-all">
                Submit
            </button>

            <h3 class="mt-6 text-xl font-semibold text-center text-gray-800">
                Generated PDF: <a id="pdfLink" href="#" class="text-blue-600 underline"></a>
            </h3>
        </form> -->
             <!-- Submit Button -->
<button type="button" onclick="submitForm()" 
class="w-full bg-gradient-to-r from-blue-500 to-blue-700 text-white font-bold py-3 rounded-lg shadow-md hover:scale-105 transition-all">
 Submit
</button>
<h3 class="mt-6 text-xl font-semibold text-center text-gray-800">
 <span id="totalScore"></span>
</h3>
<script>
   function calculateScore() {
    let score = 0;
    let radios = document.querySelectorAll("input[type=radio]:checked");
    
    radios.forEach(radio => {
        score += parseInt(radio.value);
    });

    let adjustedScore = Math.round((score / 100) * 850);

   
    adjustedScore = isNaN(adjustedScore) ? 0 : adjustedScore;

   
    localStorage.setItem("totalScore", score);
    localStorage.setItem("adjustedScore", adjustedScore);
}


document.querySelectorAll("input[type=radio]").forEach(radio => {
    radio.addEventListener("change", calculateScore);
});
async function generateAndUploadPDF() {
    let pdf = new jsPDF();
    
    // Convert HTML content to Canvas
    let canvas = await html2canvas(document.body);
    let imgData = canvas.toDataURL("image/png");
    
    pdf.addImage(imgData, "PNG", 10, 10, 180, 160);
    
    // Convert to Blob
    let pdfBlob = pdf.output("blob");
    let formData = new FormData();
    formData.append("file", pdfBlob, "result.pdf");
    formData.append("user_id", "1");

    try {
        let response = await fetch("https://demowebiste.xyz/redevelopment/api.php", {
            method: "POST",
            body: formData
        });
        let result = await response.json();
        
        if (result.status === "success") {
            alert("PDF Uploaded: " + result.file_url);
        } else {
            alert("Upload failed!");
        }
    } catch (error) {
        console.error("Upload Error:", error);
    }
}

// Call function after redirecting to result page
setTimeout(generateAndUploadPDF, 1000);


function submitForm() {
    calculateScore(); // Ensure latest score is updated before submit

    let societyName = document.getElementById("societyName").value;
    let email = document.getElementById("email").value;
    let phone = document.getElementById("phone").value;
    let street = document.getElementById("street").value;
    let landmark = document.getElementById("landmark").value;
    let pincode = document.getElementById("pincode").value;
    let state = document.getElementById("state").value;
    let country = document.getElementById("country").value;

    let adjustedScore = localStorage.getItem("adjustedScore") || "0";

    localStorage.setItem("societyName", societyName);
    localStorage.setItem("email", email);
    localStorage.setItem("phone", phone);
    localStorage.setItem("address", `${street}, ${landmark}, ${state}, ${country} - ${pincode}`);
    localStorage.setItem("finalScore", adjustedScore);

    setTimeout(() => {
        window.location.href = "resultpdf.html";
    }, 500);
}

//  async function submitForm() {
//     const { jsPDF } = window.jspdf;
//     const doc = new jsPDF();
//     calculateScore(); // Ensure latest score is updated before submit

//     let societyName = document.getElementById("societyName").value;
//     let email = document.getElementById("email").value;
//     let phone = document.getElementById("phone").value;
//     let street = document.getElementById("street").value;
//     let landmark = document.getElementById("landmark").value;
//     let pincode = document.getElementById("pincode").value;
//     let state = document.getElementById("state").value;
//     let country = document.getElementById("country").value;

//     let adjustedScore = localStorage.getItem("adjustedScore") || "0";

//     localStorage.setItem("societyName", societyName);
//     localStorage.setItem("email", email);
//     localStorage.setItem("phone", phone);
//     localStorage.setItem("address", `${street}, ${landmark}, ${state}, ${country} - ${pincode}`);
//     localStorage.setItem("finalScore", adjustedScore);
//     let address = `${street}, ${landmark}, ${state}, ${country} - ${pincode}`;
// localStorage.setItem("address", address);

// doc.text(`Address: ${address}`, 10, 50);

//     doc.text(`Society Name: ${societyName}`, 10, 20);
//     doc.text(`Email: ${email}`, 10, 30);
//     doc.text(`Phone: ${phone}`, 10, 40);
//     doc.text(`Address: ${address}`, 10, 50);
//     doc.text(`Final Score: ${adjustedScore}`, 10, 60);

//     const pdfBlob = doc.output("blob");
//     const formData = new FormData();
//     formData.append("pdf", pdfBlob, "report.pdf");

//     try {
//         const response = await fetch("http://localhost:5000/upload-pdf", {
//             method: "POST",
//             body: formData,
//         });

//         const data = await response.json();
//         if (data.success) {
//             document.getElementById("pdfLink").href = data.pdfUrl;
//             document.getElementById("pdfLink").textContent = "Download PDF";
//         } else {
//             alert("Error uploading PDF");
//         }
//     } catch (error) {
//         console.error("Upload failed:", error);
//     }
// }

    </script>
    

</body>
</html>